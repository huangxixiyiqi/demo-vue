(function(){"use strict";var t={8389:function(t,e,r){var a=r(1529),s=r(9870),n=r.n(s),o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content bg-purple-dark"},[e("SearchNavigate",{on:{"tab-change":t.handleTabChange}})],1)]),"first"===t.currentTab?e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content bg-purple-dark"},[e("Text2Image")],1)]):t._e(),"second"===t.currentTab?e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content bg-purple-dark"},[e("Image2Text")],1)]):t._e()],1)],1)},i=[],l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text2image"},[0===t.products.length?e("div",{staticClass:"placeholder"}):e("ProductList",{attrs:{products:t.products}}),e("el-form",{ref:"form",attrs:{model:t.form}},[e("el-form-item",[e("el-input",{staticClass:"custom-textarea",attrs:{type:"textarea",placeholder:"请输入查询内容"},model:{value:t.form.query,callback:function(e){t.$set(t.form,"query",e)},expression:"form.query"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")])],1)],1)],1)},c=[],u=r(8207),d=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},t._l(t.paginatedProducts,(function(r,a){return e("el-col",{key:a,attrs:{span:6}},[e("el-card",{staticStyle:{height:"450px"},attrs:{shadow:"hover"}},[e("el-image",{staticStyle:{"max-width":"100%",height:"300px"},attrs:{src:r.product.product_images,"preview-src-list":[r.product.product_images],fit:"cover"},scopedSlots:t._u([{key:"error",fn:function(){return[e("div",{staticClass:"image-error"},[t._v("加载失败")])]},proxy:!0}],null,!0)}),e("div",{on:{click:function(e){return t.showProductDetails(r)}}},[e("div",{staticClass:"product-title"},[t._v("商品名称: "+t._s(r.product.product_name))]),e("div",{staticClass:"product-ranking"},[t._v("排名: "+t._s(r.rank))]),e("div",{staticClass:"product-score"},[t._v("得分: "+t._s(r.score))])])],1)],1)})),1),e("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.totalItems,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleCurrentChange}})],1)],1),e("ProductDetailsDialog",{attrs:{visible:t.dialogTableVisible,product:t.selectedProduct},on:{"update:visible":function(e){t.dialogTableVisible=e}}})],1)},p=[],g=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"商品详细信息",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.selectedProduct?e("div",{staticClass:"dialog-content"},[e("div",[e("strong",[t._v("排名: ")]),t._v(" "+t._s(t.selectedProduct.rank))]),e("div",[e("strong",[t._v("得分: ")]),t._v(" "+t._s(t.selectedProduct.score))]),e("div",[e("strong",[t._v("商品代码: ")]),t._v(" "+t._s(t.selectedProduct.id))]),e("div",[e("strong",[t._v("商品地址: ")]),e("a",{attrs:{href:t.selectedProduct.product.product_url,target:"_blank"}},[t._v(t._s(t.selectedProduct.product.product_url))])]),e("div",[e("strong",[t._v("商品名称: ")]),t._v(" "+t._s(t.selectedProduct.product.product_name))]),e("div",[e("strong",[t._v("商品价格: ")]),t._v(" "+t._s(t.selectedProduct.product.product_price))]),e("div",[e("strong",[t._v("商品图片: ")])]),"string"===typeof t.selectedProduct.product.product_images?e("div",[e("ul",[e("li",[e("a",{attrs:{href:t.selectedProduct.product.product_images,target:"_blank"}},[t._v(t._s(t.selectedProduct.product.product_images))])])])]):e("div",[e("ul",t._l(t.selectedProduct.product.product_images,(function(r,a){return e("li",{key:a},[e("a",{attrs:{href:r.file_url,target:"_blank"}},[t._v(t._s(r.file_url))])])})),0)]),e("div",[e("strong",[t._v("商品介绍: ")])]),e("ul",t._l(t.selectedProduct.product.product_intro,(function(r,a){return e("li",{key:a},t._l(r,(function(r,a){return e("div",{key:a},[e("strong",[t._v(t._s(a)+":")]),t._v(" "+t._s(r))])})),0)})),0),e("div",[e("strong",[t._v("商品规格: ")])]),e("ul",t._l(t.selectedProduct.product.product_spec,(function(r,a){return e("li",{key:a},t._l(r,(function(r,a){return e("div",{key:a},[e("strong",[t._v(t._s(a)+":")]),t._v(" "+t._s(r))])})),0)})),0)]):t._e()])},v=[],_={name:"ProductDetailsDialog",props:{visible:{type:Boolean,required:!0},product:{type:Object,default:null}},computed:{dialogVisible:{get(){return this.visible},set(t){this.$emit("update:visible",t)}},selectedProduct(){return this.product}}},f=_,h=r(1656),m=(0,h.A)(f,g,v,!1,null,"3b12c1ee",null),b=m.exports,P={name:"ProductList",components:{ProductDetailsDialog:b},props:{products:{type:Array,required:!0}},data(){return{currentPage:1,itemsPerPage:8,dialogTableVisible:!1,selectedProduct:null}},computed:{paginatedProducts(){const t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;return this.products.slice(t,e)},totalItems(){return this.products.length}},methods:{handleCurrentChange(t){this.currentPage=t},showProductDetails(t){this.selectedProduct=t,this.dialogTableVisible=!0}}},y=P,C=(0,h.A)(y,d,p,!1,null,"2b066ade",null),k=C.exports;const x="http://118.31.229.116:6009";var w={API_BASE_URL:x},S={name:"Text2Image",components:{ProductList:k},data(){return{form:{query:""},products:[]}},methods:{async onSubmit(){try{const t=new FormData;t.append("qid",this.form.query),console.log("查询请求数据:",t);const e=await u.A.post(`${w.API_BASE_URL}/ret/search_data_all/`,t,{headers:{"Content-Type":"multipart/form-data"}});console.log(e.data.data.results),this.products=e.data.data.results||[],console.log("查询成功:",this.products)}catch(t){console.error("查询失败:",t)}}}},T=S,A=(0,h.A)(T,l,c,!1,null,"44a5731a",null),D=A.exports,O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-navigate"},[e("el-tabs",{staticClass:"tabs",on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"文本检索图像",name:"first"}}),e("el-tab-pane",{attrs:{label:"图像检索文本",name:"second"}})],1)],1)},U=[],I={name:"SearchNavigate",data(){return{activeName:"first"}},methods:{handleClick(t,e){console.log(t,e),this.$emit("tab-change",t.name)}}},V=I,j=(0,h.A)(V,O,U,!1,null,"085d97ea",null),q=j.exports,L=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image2text"},[e("div",{staticClass:"upload"},[e("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:t.uploadUrl,name:"image","on-success":t.handleSuccess,"before-upload":t.handleBeforeUpload}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),e("em",[t._v("点击上传")])]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("上传待检索图片")])]),t.previewUrl?e("div",{staticClass:"preview"},[e("el-image",{staticStyle:{"max-width":"100%",height:"300px"},attrs:{src:t.previewUrl,"preview-src-list":[t.previewUrl],fit:"cover"},scopedSlots:t._u([{key:"error",fn:function(){return[e("div",{staticClass:"image-error"},[t._v("加载失败")])]},proxy:!0}],null,!1,3353169236)})],1):t._e()],1),t._l(t.paginatedProducts,(function(r,a){return e("div",{key:a,staticClass:"product-descriptions"},[e("el-descriptions",{staticClass:"margin-top",staticStyle:{cursor:"pointer"},attrs:{title:`检索结果 ${(t.currentPage-1)*t.pageSize+a+1}`,column:1,border:""},nativeOn:{click:function(e){return t.showProductDetails(r)}}},[e("el-descriptions-item",{attrs:{label:"商品名称","label-class-name":"descriptions-label","content-class-name":"descriptions-content"}},[t._v(" "+t._s(r.product.product_name)+" ")]),e("el-descriptions-item",{attrs:{label:"排名","label-class-name":"descriptions-label","content-class-name":"descriptions-content"}},[t._v(" "+t._s(r.rank)+" ")]),e("el-descriptions-item",{attrs:{label:"得分","label-class-name":"descriptions-label","content-class-name":"descriptions-content"}},[t._v(" "+t._s(r.score)+" ")])],1)],1)})),0===t.products.length?e("div",{staticClass:"margin-top"},[t._v("暂无检索结果")]):t._e(),t.products.length>0?e("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next",total:t.products.length,"page-size":t.pageSize,"current-page":t.currentPage},on:{"current-change":t.handlePageChange}}):t._e(),e("ProductDetailsDialog",{attrs:{visible:t.dialogTableVisible,product:t.selectedProduct},on:{"update:visible":function(e){t.dialogTableVisible=e}}})],2)},N=[],z={name:"Image2Text",components:{ProductDetailsDialog:b},data(){return{uploadUrl:`${w.API_BASE_URL}/i2t/searchi2t_data_all/`,products:[],uploaded_image_url:"",previewUrl:"",currentPage:1,pageSize:10,dialogTableVisible:!1,selectedProduct:null}},computed:{paginatedProducts(){const t=(this.currentPage-1)*this.pageSize,e=this.currentPage*this.pageSize;return this.products.slice(t,e)}},methods:{handleSuccess(t,e){console.log("服务器返回数据:",t),console.log("上传的文件信息:",e),this.products=t.data.results||[],this.uploaded_image_url=t.data.uploaded_image,this.currentPage=1},handleBeforeUpload(t){const e=new FileReader;return e.onload=t=>{this.previewUrl=t.target.result},e.readAsDataURL(t),!0},handlePageChange(t){this.currentPage=t},showProductDetails(t){this.selectedProduct=t,this.dialogTableVisible=!0}}},B=z,$=(0,h.A)(B,L,N,!1,null,null,null),R=$.exports,E={name:"App",components:{SearchNavigate:q,Text2Image:D,Image2Text:R},data(){return{currentTab:"first"}},methods:{handleTabChange(t){this.currentTab=t}}},F=E,M=(0,h.A)(F,o,i,!1,null,null,null),G=M.exports;a["default"].use(n()),new a["default"]({el:"#app",render:t=>t(G)})}},e={};function r(a){var s=e[a];if(void 0!==s)return s.exports;var n=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}r.m=t,function(){r.amdO={}}(),function(){var t=[];r.O=function(e,a,s,n){if(!a){var o=1/0;for(u=0;u<t.length;u++){a=t[u][0],s=t[u][1],n=t[u][2];for(var i=!0,l=0;l<a.length;l++)(!1&n||o>=n)&&Object.keys(r.O).every((function(t){return r.O[t](a[l])}))?a.splice(l--,1):(i=!1,n<o&&(o=n));if(i){t.splice(u--,1);var c=s();void 0!==c&&(e=c)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[a,s,n]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){r.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={524:0};r.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,n,o=a[0],i=a[1],l=a[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(l)var u=l(r)}for(e&&e(a);c<o.length;c++)n=o[c],r.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return r.O(u)},a=self["webpackChunkdemo"]=self["webpackChunkdemo"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=r.O(void 0,[504],(function(){return r(8389)}));a=r.O(a)})();
//# sourceMappingURL=app.f309af88.js.map